<?xml version="1.0"?>
<robot name="inmoov_176cm_full">

  <material name="white"><color rgba="0.95 0.95 0.95 1"/></material>
  <material name="sensor_red"><color rgba="0.8 0.1 0.1 1"/></material>
  <material name="sensor_blue"><color rgba="0.1 0.1 0.8 1"/></material>
  <material name="flex_black"><color rgba="0.2 0.2 0.2 1"/></material>

  <link name="world"/>

  <link name="base_link">
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="package://wearable_pkg/meshes/r_shoulder_base.stl" scale="0.001 0.001 0.001"/>
      </geometry>
      <material name="white"/>
    </visual>
    <inertial><mass value="1.0"/><inertia ixx="0.01" ixy="0" ixz="0" iyy="0.01" iyz="0" izz="0.01"/></inertial>
  </link>

  <joint name="fixed_base" type="fixed">
    <parent link="world"/>
    <child link="base_link"/>
    <origin xyz="0 0 1.45" rpy="0 0 0"/>
  </joint>

  <link name="r_shoulder">
    <visual>
      <origin xyz="0 0 0" rpy="0 0 1.57"/>
      <geometry>
        <mesh filename="package://wearable_pkg/meshes/r_shoulder.stl" scale="0.001 0.001 0.001"/>
      </geometry>
      <material name="white"/>
    </visual>
    <inertial><mass value="0.5"/><inertia ixx="0.005" ixy="0" ixz="0" iyy="0.005" iyz="0" izz="0.005"/></inertial>
  </link>

  <joint name="r_shoulder_yaw" type="revolute">
    <parent link="base_link"/>
    <child link="r_shoulder"/>
    <origin xyz="0 0 0" rpy="0 0 0"/>
    <axis xyz="0 0 1"/> <limit lower="-1.57" upper="0.5" effort="10" velocity="1.0"/>
  </joint>

  <link name="r_bicep">
    <visual>
      <origin xyz="0.025 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="package://wearable_pkg/meshes/bicep.stl" scale="0.001 0.001 0.0013"/>
      </geometry>
      <material name="white"/>
    </visual>
    <inertial><mass value="1.0"/><inertia ixx="0.01" ixy="0" ixz="0" iyy="0.01" iyz="0" izz="0.01"/></inertial>
  </link>

  <joint name="r_bicep_joint" type="fixed"> 
    <parent link="r_shoulder"/>
    <child link="r_bicep"/>
    <origin xyz="0.05 0 -0.05" rpy="0 0 0"/>
  </joint>

  <joint name="r_elbow_pitch" type="revolute">
    <parent link="r_bicep"/>
    <child link="r_elbow_link"/> <origin xyz="0 0 -0.30" rpy="0 0 0"/>
    <axis xyz="1 0 0"/> 
    <limit lower="0.0" upper="2.0" effort="10" velocity="1.0"/>
  </joint>

  <link name="r_elbow_link">
    <inertial>
      <mass value="0.05"/>
      <inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001"/>
    </inertial>
  </link>

  <joint name="r_forearm_roll" type="revolute">
    <parent link="r_elbow_link"/>
    <child link="r_forearm"/>
    <origin xyz="0 0 0" rpy="0 0 0"/>
    <axis xyz="0 0 1"/> <limit lower="-1.57" upper="1.57" effort="5" velocity="1.0"/>
  </joint>

  <link name="r_forearm">
    <visual>
      <origin xyz="0 0 0.01" rpy="0 0 0"/>
      <geometry>
        <mesh filename="package://wearable_pkg/meshes/r_forearm.stl" scale="0.001 0.001 0.0009"/>
      </geometry>
      <material name="white"/>
    </visual>
    <inertial><mass value="0.8"/><inertia ixx="0.01" ixy="0" ixz="0" iyy="0.01" iyz="0" izz="0.005"/></inertial>
  </link>

  <link name="imu_brachioradialis">
    <visual><geometry><box size="0.02 0.01 0.03"/></geometry><material name="sensor_red"/></visual>
    <inertial><mass value="0.01"/><inertia ixx="1e-5" ixy="0" ixz="0" iyy="1e-5" iyz="0" izz="1e-5"/></inertial>
  </link>
  <joint name="fix_imu_brachio" type="fixed">
    <parent link="r_forearm"/>
    <child link="imu_brachioradialis"/>
    <origin xyz="0.04 0 -0.05" rpy="0 0 0"/>
  </joint>

  <link name="imu_wrist">
    <visual><geometry><box size="0.02 0.01 0.03"/></geometry><material name="sensor_blue"/></visual>
    <inertial><mass value="0.01"/><inertia ixx="1e-5" ixy="0" ixz="0" iyy="1e-5" iyz="0" izz="1e-5"/></inertial>
  </link>
  <joint name="fix_imu_wrist" type="fixed">
    <parent link="r_forearm"/>
    <child link="imu_wrist"/>
    <origin xyz="0.01 0 -0.24" rpy="0 0 0"/>
  </joint>

  <joint name="r_wrist_pitch" type="revolute">
    <parent link="r_forearm"/>
    <child link="r_hand"/>
    <origin xyz="0 0 -0.26" rpy="0 0 0"/>
    <axis xyz="1 0 0"/> <limit lower="-0.5" upper="0.5" effort="5" velocity="1.0"/>
  </joint>

  <link name="r_hand">
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="package://wearable_pkg/meshes/r_hand.stl" scale="0.001 0.001 0.001"/>
      </geometry>
      <material name="white"/>
    </visual>
    <inertial><mass value="0.3"/><inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001"/></inertial>
  </link>

  <link name="r_index1">
    <visual>
      <origin xyz="-0.033 0 -0.03" rpy="0 0 0"/>
      <geometry>
        <mesh filename="package://wearable_pkg/meshes/index3_1.stl" scale="0.001 0.001 0.001"/>
      </geometry>
      <material name="white"/>
    </visual>
    <inertial><mass value="0.01"/><inertia ixx="1e-5" ixy="0" ixz="0" iyy="1e-5" iyz="0" izz="1e-5"/></inertial>
  </link>

  <joint name="r_index_knuckle" type="revolute">
    <parent link="r_hand"/>
    <child link="r_index1"/>
    <origin xyz="0.03 0 -0.08" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <limit lower="0.0" upper="1.57" effort="1" velocity="2.0"/>
  </joint>

  <link name="flex_sensor">
    <visual><geometry><box size="0.01 0.03 0.001"/></geometry><material name="flex_black"/></visual>
    <inertial><mass value="0.001"/><inertia ixx="1e-6" ixy="0" ixz="0" iyy="1e-6" iyz="0" izz="1e-6"/></inertial>
  </link>
  <joint name="fix_flex" type="fixed">
    <parent link="r_index1"/>
    <child link="flex_sensor"/>
    <origin xyz="-0.03 0.005 -0.02" rpy="1.57 0 1.57"/>
  </joint>

  <link name="r_index2">
    <visual>
      <geometry><mesh filename="package://wearable_pkg/meshes/index3_2.stl" scale="0.001 0.001 0.001"/></geometry>
      <material name="white"/>
    </visual>
    <inertial><mass value="0.01"/><inertia ixx="1e-5" ixy="0" ixz="0" iyy="1e-5" iyz="0" izz="1e-5"/></inertial>
  </link>

  <joint name="r_index_mid" type="revolute">
    <parent link="r_index1"/>
    <child link="r_index2"/>
    <origin xyz="-0.035 0 -0.07" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <limit lower="0.0" upper="1.57" effort="1.0" velocity="1.0"/>
  </joint>

  <link name="r_index3">
    <visual>
      <geometry><mesh filename="package://wearable_pkg/meshes/index3_3.stl" scale="0.001 0.001 0.001"/></geometry>
      <material name="white"/>
    </visual>
    <inertial><mass value="0.01"/><inertia ixx="1e-5" ixy="0" ixz="0" iyy="1e-5" iyz="0" izz="1e-5"/></inertial>
  </link>

  <joint name="r_index_tip" type="revolute">
    <parent link="r_index2"/>
    <child link="r_index3"/>
    <origin xyz="0 0 -0.03" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <limit lower="0.0" upper="1.57" effort="1.0" velocity="1.0"/>
  </joint>

  <gazebo>
    <plugin filename="gz-sim-joint-position-controller-system" name="gz::sim::systems::JointPositionController">
      <joint_name>r_shoulder_yaw</joint_name>
      <p_gain>50</p_gain>
      <i_gain>0.1</i_gain>
      <d_gain>0.1</d_gain>
      <topic>/model/wearable_hand/joint/r_shoulder_yaw/cmd_pos</topic>
    </plugin>

    <plugin filename="gz-sim-joint-position-controller-system" name="gz::sim::systems::JointPositionController">
      <joint_name>r_elbow_pitch</joint_name>
      <p_gain>50</p_gain>
      <i_gain>0.1</i_gain>
      <d_gain>0.1</d_gain>
      <topic>/model/wearable_hand/joint/r_elbow_pitch/cmd_pos</topic>
    </plugin>

    <plugin filename="gz-sim-joint-position-controller-system" name="gz::sim::systems::JointPositionController">
      <joint_name>r_forearm_roll</joint_name>
      <p_gain>20</p_gain>
      <i_gain>0.1</i_gain>
      <d_gain>0.01</d_gain>
      <topic>/model/wearable_hand/joint/r_forearm_roll/cmd_pos</topic>
    </plugin>

    <plugin filename="gz-sim-joint-position-controller-system" name="gz::sim::systems::JointPositionController">
      <joint_name>r_wrist_pitch</joint_name>
      <p_gain>10</p_gain> <i_gain>0.1</i_gain> <d_gain>0.1</d_gain>
      <topic>/model/wearable_hand/joint/r_wrist_pitch/cmd_pos</topic>
    </plugin>

    <plugin filename="gz-sim-joint-position-controller-system" name="gz::sim::systems::JointPositionController">
      <joint_name>r_index_knuckle</joint_name>
      <p_gain>2</p_gain> <i_gain>0.01</i_gain> <d_gain>0.01</d_gain>
      <topic>/model/wearable_hand/joint/r_index_knuckle/cmd_pos</topic>
    </plugin>

    <plugin filename="gz-sim-joint-position-controller-system" name="gz::sim::systems::JointPositionController">
      <joint_name>r_index_mid</joint_name>
      <p_gain>2</p_gain> <i_gain>0.01</i_gain> <d_gain>0.01</d_gain>
      <topic>/model/wearable_hand/joint/r_index_mid/cmd_pos</topic>
    </plugin>

    <plugin filename="gz-sim-joint-position-controller-system" name="gz::sim::systems::JointPositionController">
      <joint_name>r_index_tip</joint_name>
      <p_gain>2</p_gain> <i_gain>0.01</i_gain> <d_gain>0.01</d_gain>
      <topic>/model/wearable_hand/joint/r_index_tip/cmd_pos</topic>
    </plugin>
  </gazebo>
</robot>